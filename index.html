<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="UTF-8">
  <title>Jogo Beat'em Up</title>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/p5.js/1.4.2/p5.min.js"></script>
</head>
<body>
<script>
let player;
let enemies = [];
let trees = [];
let bullets = [];
let cameraX = 0;

function setup() {
  createCanvas(800, 400);
  // Inicializa o jogador
  player = {
    x: 100,
    y: 300,
    speed: 5,
    width: 20,
    height: 40
  };
  // Cria árvores
  for (let i = 0; i < 10; i++) {
    trees.push({
      x: random(0, 2000),
      y: random(100, 350),
      size: 60
    });
  }
  // Cria inimigos
  for (let i = 0; i < 5; i++) {
    enemies.push({
      x: random(200, 2000),
      y: random(250, 350),
      width: 20,
      height: 40,
      speed: 2,
      alive: true
    });
  }
}

function draw() {
  background(100, 150, 100); // Fundo verde (grama)
  
  // Atualiza a posição da câmera
  cameraX = player.x - width / 2;
  if (cameraX < 0) cameraX = 0;
  
  // Aplica a transformação da câmera
  push();
  translate(-cameraX, 0);
  
  // Desenha o chão
  fill(150, 100, 50);
  rect(0, 300, 2000, 100);
  
  // Desenha árvores
  fill(139, 69, 19); // Marrom para tronco
  stroke(0);
  for (let tree of trees) {
    rect(tree.x - 10, tree.y - 20, 20, 40); // Tronco
    fill(34, 139, 34); // Verde para folhas
    ellipse(tree.x, tree.y - 30, tree.size, tree.size); // Folhas
  }
  
  // Desenha o jogador (figura humanoide)
  fill(0, 0, 255);
  drawHumanoid(player.x, player.y, player.width, player.height);
  
  // Atualiza e desenha balas
  fill(255, 255, 0); // Amarelo para balas
  for (let i = bullets.length - 1; i >= 0; i--) {
    let bullet = bullets[i];
    bullet.x += bullet.speed;
    ellipse(bullet.x, bullet.y, 10, 5); // Bala como elipse pequena
    
    // Remove balas que saem da tela
    if (bullet.x > cameraX + width || bullet.x < cameraX) {
      bullets.splice(i, 1);
      continue;
    }
    
    // Verifica colisão com inimigos
    for (let j = enemies.length - 1; j >= 0; j--) {
      let enemy = enemies[j];
      if (enemy.alive && dist(bullet.x, bullet.y, enemy.x, enemy.y) < (player.width + enemy.width) / 2) {
        enemies.splice(j, 1); // Remove inimigo atingido
        bullets.splice(i, 1); // Remove bala
        break;
      }
    }
  }
  
  // Desenha e atualiza inimigos
  fill(255, 0, 0);
  for (let enemy of enemies) {
    if (enemy.alive) {
      // Movimento em direção ao jogador
      let dx = player.x - enemy.x;
      let dy = player.y - enemy.y;
      let distance = sqrt(dx * dx + dy * dy);
      if (distance > 5) { // Evita tremulação quando muito próximo
        enemy.x += (dx / distance) * enemy.speed;
        enemy.y += (dy / distance) * enemy.speed;
      }
      drawHumanoid(enemy.x, enemy.y, enemy.width, enemy.height);
    }
  }
  
  pop();
  
  // Controles do jogador
  if (keyIsDown(LEFT_ARROW)) {
    player.x -= player.speed;
    if (player.x < 0) player.x = 0;
  }
  if (keyIsDown(RIGHT_ARROW)) {
    player.x += player.speed;
    if (player.x > 2000) player.x = 2000;
  }
  if (keyIsDown(UP_ARROW)) {
    player.y -= player.speed;
    if (player.y < 250) player.y = 250;
  }
  if (keyIsDown(DOWN_ARROW)) {
    player.y += player.speed;
    if (player.y > 350) player.y = 350;
  }
}

// Função para desenhar figura humanoide
function drawHumanoid(x, y, w, h) {
  // Corpo
  rect(x - w / 2, y - h / 2, w, h);
  // Cabeça
  ellipse(x, y - h / 2 - 10, w, w);
  // Braços
  line(x - w / 2, y - h / 4, x - w - 10, y);
  line(x + w / 2, y - h / 4, x + w + 10, y);
  // Pernas
  line(x - w / 4, y + h / 2, x - w / 4, y + h / 2 + 20);
  line(x + w / 4, y + h / 2, x + w / 4, y + h / 2 + 20);
}

// Atirar com a tecla Espaço
function keyPressed() {
  if (keyCode === 32) { // Tecla Espaço
    bullets.push({
      x: player.x + player.width / 2,
      y: player.y,
      speed: 10
    });
  }
}
</script>
</body>
</html>
